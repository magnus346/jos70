<!DOCTYPE html>
<html>
<head>
  <title>Socket Broadcaster</title>
  <script src="/socket.io/socket.io.js"></script>
  <style>body { width:100%; height:100vh; }</style>
</head>
<body>
  <audio id="right" src="audio-right.mp3" preload="auto"></audio>
  <audio id="wrong" src="audio-wrong.mp3" preload="auto"></audio>
  <script>
    const socket = io();

    const toBlack = () => {
      document.body.style.background = "black";
    };

    const playAudio = (audio) => {
      audio.pause();
      audio.currentTime = 0;
      audio.play();
    }

    const playRight = () => {
      if(!taped) return false;
      document.body.style.background = "green";
      playAudio(document.getElementById("right"));
      setTimeout(() => { toBlack(); }, 2000);
    };

    const playWrong = () => {
      if(!taped) return false;
      document.body.style.background = "red";
       playAudio(document.getElementById("wrong"));
      setTimeout(() => { toBlack(); }, 2000);
    };

    let taped = false;
    document.addEventListener('click', () => { taped = true; toBlack(); });
    
    socket.on('message', msg => {
      if(msg === 'right')
        playRight();
      if(msg === 'wrong')
        playWrong();
    });
  </script>
</body>
</html>
